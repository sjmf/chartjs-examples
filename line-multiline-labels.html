<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Line Chart</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.bundle.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <style>
    canvas{
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }
    </style>
</head>

<body>
    <div style="width:90%;">
        <canvas id="canvas"></canvas>
    </div>

    <script>

        var randomColor = function(opacity) {
            return 'rgba(' + Math.round(Math.random() * 255) + ',' + Math.round(Math.random() * 255) + ',' + Math.round(Math.random() * 255) + ',' + (opacity || '.3') + ')';
        };

        var assignColors = function(config) {
            $.each(config.data.datasets, function(i, dataset) {
                dataset.borderColor = randomColor(0.4);
                dataset.backgroundColor = randomColor(0.5);
                dataset.pointBorderColor = randomColor(0.7);
                dataset.pointBackgroundColor = randomColor(0.5);
                dataset.pointBorderWidth = 1;
                dataset.fill = false;
                //dataset.borderDash = [5, 5];
            });
        }

        var config = {
            type: 'line',
            data: { 
                labels: [], 
                datasets : [] 
            },
            options: {
                responsive: true,
                title:{
                    display:true,
                    text:'Chart.js Line Chart, with Electrical data loaded from file'
                },
                hover: {
                    mode: 'dataset'
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            show: true,
                            labelString: 'Time'
                        }
                    }],
                    yAxes: [{
                        display: true,
                        scaleLabel: {
                            show: true,
                            labelString: 'Value'
                        },
/*                        ticks: {
                            suggestedMin: -10,
                            suggestedMax: 250,
                        }
*/
                    }]
                }
            }
        };


        window.onload = function() {
            $.ajax({
                type: "GET",
                url: 'electric.json',
                dataType: "json",
                success: function(data) {
                    console.log(data)
                    /*
                    var series = [];
                    for(var s in data) {
                        series.push(s);
                    
                        var keys = [];
                        var values = [];
                        for(var k in data[s]) {
                            keys.push(k);
                            values.push(data[s][k])
                        }

                        config.data.datasets.push({
                            label: keys,
                            data: values
                        })
                    }*/
                    var s = '3'; // Series to fudge

                    for( i in data[s] )
                        config.data.labels.push(new Date(i))

                    var values = [];
                    for( i in data[s] )
                        values.push(data[s][i])

                    config.data.datasets.push({
                        label: "Sensor 3",
                        data:  values
                    })


                    //console.log(series.length + " series: " + series);
                    
                    assignColors(config);

                    console.log(config)
                    
                    var ctx = document.getElementById("canvas").getContext("2d");
                    window.myLine = new Chart(ctx, config);
                },
                error: function(xhr, ajaxOptions, err) {
                    console.error(err);
                    console.error(xhr.status);
                }
            });
        };




    </script>
</body>

</html>
